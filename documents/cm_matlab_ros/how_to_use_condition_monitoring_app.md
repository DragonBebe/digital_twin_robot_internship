In this document, you will find a tutorial on how to use the condition-monitoring application to collect the realtime condition-monitoring data from the robot. The condition-monitoring application is developed in Matlab application designer. It will collect the position, temperature and voltage of the six motors of the robot in realtime, and once the collection is stopped, the collected data will be saved in a .csv files.

## Requirements
- Matlab R2023a or later
- For the robot, we use [Hiwonder ArmPi FPV](https://www.hiwonder.com/products/armpi-fpv?variant=39341129203799). This is a robot based on Rapspebery Pi 4 and ROS 1 Melodic.

## Prepare the robot

We develop a ROS package to read the status of each motor at a given frequency, and publish to a ros topic "condition_monitoring". The source code is available [here](/robot_digital_twin/catkin_ws/cm/scripts/condition_monitoring.py). **Please do not edit this file in Windows**, as the script will be run in Linux and the encoding protocal is different in Windows and Linux, which will cause the program to crash.



The application *app_prototype.mlapp* shows for a single motor (moter 1), how to:
1. Connect to the robot and read condition-monitoring data through defining a subscriber.
2. Extract the condition-monitoring data from the message from ROS.
3. Visualize in realtime the position, temperature and voltage.
4. Save the collected data in a .csv file.

To test it, you should follow the following steps:
1. Start the condition-monitoring program in the robot or create a fake robot for testing (for this, please refer to the tuturial [here](create_a_fake_robot_for_testing.md)).
2. Change the ip address in the rosinit function to the ip address of the actual or fake robot.
3. Click the *start* button to start data collection and data visualization. 
4. Click the *stop* button to save the collected data.

The program will visualize the collected data in realtime:

![Alt text](screen_shots/result_3.gif)

The collected data will be saved in the currect dictionary as a csv file as the following:

![](screen_shots/result_4.png)
